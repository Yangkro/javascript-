### JS的线程和事件机制
#### 线程和进程
* 进程：是CPU资源分配的最小单位（是能够拥有资源和独立运行的最小单位）
* 线程：是CPU调度的最小单位（线程是建立在进程基础上的一次程序运行单位，一个进程中可以有多个线程）
* JS是单线程运行的
由于JS是单线程的，也就是说<font color="red">在一段时间只能做一件事， 即同步执行</font>在一个任务结束以后才能执行另一个任务，执行的顺序与排列的顺序相同。但是使用使用H5的web Workers可以实现多线程运行在以一个花费很长时间的事件时可以处理其他任务，<font color="red">即异步执行</font>。
    * 同步任务
    同步任务都是在主线程上执行，形成了一个<font color="red">执行栈</font>
    * 异步任务
    <fonr color="red">异步任务一般都是通过回调函数来实现的</font>，一般而言有一下三种：
        1. 普通事件，如click、resize等
        2. 资源加载， 如onload、error等
        3. 定时器，如setInterval、setTimeout等
    所有的异步任务相关的回调函数都添加到<font color="red">任务队列（消息队列）</font>
    **执行机制**
    通过事件循环机制（event loop）反复查看任务队列中是否还有异步任务，保证异步任务不会被拉下（例如click事件，是在点击之后将回调函数放入到任务队列中，事件循环机制保证其能够被调入栈中执行）。
    1. 先执行<font color="red">执行栈中的同步任务</font>
    2. 遇到回调函数，放入任务队列中
    3. 一旦执行完执行栈中的同步任务，系统会按照顺序依次读取任务队列中的异步任务，被读取的异步任务结束等待状态，进入执行栈，开始执行。
#### 浏览器内核
支撑浏览器运行的最核心的程序，负责页面的渲染，脚本的执行，以及事件的处理（可以认为每一个tab页都是一个渲染进程）。<font color="red">渲染进程是多线程的蛀牙包括以下线程</font>
* 浏览器渲染进程中的线程
    * GUI渲染线程
        * 负责渲染页面，布局和绘制
        * 页面需要重绘和回流时，该线程会执行
        * 与JS引擎线程互斥，防止渲染结果不可预期
    * JS引擎线程
        * JS引擎线程只执行执行栈中的事件，当同步任务执行完成后，读取事件队列中的事件调入执行栈中进行处理，如果事件队列为空，则一直询问，直到有为止。
        * 负责处理解析和执行JS脚本程序
        * 只有一个JS引擎线程
        * 与GUI线程互斥，防止渲染结果不可预期<font color="red">当JS引擎线程执行时，GUI渲染线程会被挂起，GUI更新则会被保存在一个队列中等待JS引擎线程空闲时立即被执行</font>
    * 事件触发线程
        * 用来控制事件的循环（鼠标点击、setTimeout、ajax等）
        * 当事件满足触发条件时，将事件放入JS执行引擎所在的执行队列中
    * 定时触发线程
        * 定时器所在的线程
        * 定时任务并不是由JS引擎计时的，是由定时触发线程来计时的
        * 计时完毕后，通知事件触发线程
    * 异步HTTP请求线程
        * 浏览器的一个单独用于处理AJAX请求的线程
        * 当请求完成是，如有回调函数，通知事件触发线程
* 浏览器内核分类
    * webkit 代表Chrome，Safari
    * Gecko 代表Firefox
    * Trident 代表IE
    * Trident+webkit 代表360，搜狗等国内浏览器
* 参考
* [前端进阶-从多线程到Event Loop全面梳理](https://juejin.im/post/5d5b4c2df265da03dd3d73e5)